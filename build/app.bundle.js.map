{"version":3,"sources":["webpack:///webpack/bootstrap 92845e238c126671f006","webpack:///./js/app.js","webpack:///delegated ./node_modules/mithril/mithril.js from dll-reference vendor_library","webpack:///external \"vendor_library\"","webpack:///./js/components/tma-front-component.js","webpack:///./js/components/zoom-component.js","webpack:///./js/components/load-component.js","webpack:///./js/view-model/tma-front-vm.js","webpack:///./js/view-model/load-vm.js","webpack:///./js/model/system-img.js","webpack:///./js/model/png.js","webpack:///delegated ./node_modules/base64-arraybuffer/lib/base64-arraybuffer.js from dll-reference vendor_library","webpack:///./js/model/zoom.js","webpack:///./js/model/scenario.js","webpack:///./~/tk2k-message-assist/lib/index.js","webpack:///./~/tk2k-message-assist/lib/scenario-parser.js","webpack:///./~/tk2k-message-assist/lib/message.js","webpack:///./~/tk2k-message-assist/lib/message-block.js","webpack:///./~/tk2k-message-assist/lib/config.js","webpack:///delegated ./node_modules/js-yaml/index.js from dll-reference vendor_library","webpack:///./~/tk2k-message-assist/lib/tb-serializer.js","webpack:///delegated ./node_modules/onecolor/index.js from dll-reference vendor_library"],"names":[],"mappings":"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","file":"app.bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 92845e238c126671f006\n **/","import m from 'mithril';\nimport tmaFrontComponent from 'components/tma-front-component.js';\n// import parser from 'tk2k-message-assist';\n\nm.mount(document.getElementById('appContainer'), tmaFrontComponent);\n\n\n\n/** WEBPACK FOOTER **\n ** ./js/app.js\n **/","module.exports = (__webpack_require__(2))(1);\n\n\n/*****************\n ** WEBPACK FOOTER\n ** delegated ./node_modules/mithril/mithril.js from dll-reference vendor_library\n ** module id = 1\n ** module chunks = 0\n **/","module.exports = vendor_library;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"vendor_library\"\n ** module id = 2\n ** module chunks = 0\n **/","import m from 'mithril';\nimport zoomComponent from './zoom-component';\nimport loadComponent from './load-component';\nimport TmaFrontVM from '../view-model/tma-front-vm';\nimport Zoom from '../model/zoom';\nimport Scenario from '../model/scenario';\n\nconst tmaFrontComponent = {\n  controller: function () {\n    this.zoom = new Zoom({zoomLevel: 1});\n    this.scenario = new Scenario();\n    this.vm = new TmaFrontVM({scenario: this.scenario});\n  },\n  view: (ctrl) => {\n    const windowList = ctrl.scenario.windowList;\n    const colors = ctrl.scenario.colors;\n    return [\n      m('.left', [\n        m.component(loadComponent, {vm: ctrl.vm.loadVM}),\n        m('h2', 'シナリオファイル'),\n        m('textarea#input', {\n          value: ctrl.scenario.scenarioText(),\n          onkeyup: m.withAttr('value', ctrl.scenario.scenarioText)\n        }),\n        m('h2', 'TkoolBridge script'),\n        m('textarea#tkScript', {\n          readonly: 'readonly'\n        }, [ctrl.scenario.tkScript])\n      ]),\n      m('.right', [\n        m('h2', 'プレビュー'),\n        m.component(zoomComponent, {zoom: ctrl.zoom}),\n        m('#messageList', {class: `zoom${ctrl.zoom.zoomLevel()}x`}, [\n          windowList.map((messageBox) => {\n            const face = messageBox.face;\n            return messageBox.messageList.map((message) => {\n              let messageView = [];\n              let lineView = [];\n              if (face) {\n                // TODO\n                messageView.push(m('.faceBox', [\n                  m('img.face', {src: 'https://placehold.it/96x96'})\n                ]));\n                lineView.push(makeMessageLi(face.name, colors));\n              }\n              message.line.forEach((lineText) => {\n                lineView.push(makeMessageLi(lineText, colors));\n              });\n              messageView.push(m('ul.message', lineView));\n              return m('.messageWindow', messageView);\n            });\n          })\n        ])\n      ])\n    ];\n  }\n};\n\nconst domParser = new DOMParser();\nconst makeMessageLi = (scenarioText, colors) => {\n  let html = scenarioText;\n  // エスケープの変換\n  html = html.replace('\\\\<', '&lt;')\n             .replace(/([^\\\\]?)\\\\/, '$1')\n             .replace('\\\\', '\\\\\\\\');\n  // 色タグをspanに変換\n  Object.keys(colors).forEach((color) => {\n    const number = colors[color];\n    const colorTagRegExp = new RegExp(`<${color}>`, 'g');\n    html = html.replace(colorTagRegExp, `<color${number}>`);\n  });\n  html = html.replace(startTagRegExp, '<span class=\"$1\">')\n             .replace(endTagRegExp, '</span>');\n  // DOMParserに読ませて変換する\n  const dom = domParser.parseFromString(html, 'text/html');\n  // 本文の組み立て\n  const message = domToView(dom.body);\n\n  return m('li.line', [\n    m('p.shadow', dom.body.innerText),\n    m('p.text', message)\n  ]);\n};\n\nconst domToView = (dom) => {\n  let view = [];\n  let iList = [];\n  for (let node = dom.firstChild; node; node = node.nextSibling) {\n    const klass = node.getAttribute ? node.getAttribute('class') : false;\n    if (Object.keys(controlTags).includes(klass)) {\n      // 制御タグはiタグに変えてキープ\n      iList.push(m('i', {\n        class: klass\n      }, controlTags[klass]));\n      continue;\n    } else {\n      // iタグのストックがあればspanに包んでpush\n      if (iList.length > 0) {\n        view.push(m('span', {\n          class: 'control'\n        }, iList));\n        iList = [];\n      }\n    }\n    if (node.nodeName == 'SPAN') {\n        // 他のタグはspanのまま\n        view.push(m('span', {\n          class: klass\n        }, domToView(node)));\n    } else {\n      // span以外の要素は全てテキストに変える\n      view.push(node.textContent);\n    }\n  }\n  // iタグのストックがあればspanに包んでpush\n  if (iList.length > 0) {\n    view.push(m('span', {\n      class: 'control'\n    }, iList));\n    iList = [];\n  }\n  return view;\n};\n\nconst startTagRegExp = /<([a-z0-9\\-\\_]+)>/g;\nconst endTagRegExp = /<\\/([a-z0-9\\-\\_]+)>/g;\nconst controlTags = {\n  stop: 's',\n  wait: 'w',\n  q_wait: 'q'\n};\n\nexport default tmaFrontComponent;\n\n\n\n/** WEBPACK FOOTER **\n ** ./js/components/tma-front-component.js\n **/","import m from 'mithril';\nconst zoomComponent = {\n  controller: function (args) {\n    this.zoom = args.zoom;\n  },\n  view: (ctrl) => {\n    return m('.zoomBox', [\n      'ズーム：',\n      m('select', {\n        name: 'zoom',\n        value: ctrl.zoom.zoomLevel(),\n        onchange: m.withAttr('value', ctrl.zoom.zoomLevel)\n      }, [\n        m('option', {value: 1}, '1x'),\n        m('option', {value: 2}, '2x')\n      ])\n    ]);\n  }\n};\n\nexport default zoomComponent;\n\n\n\n/** WEBPACK FOOTER **\n ** ./js/components/zoom-component.js\n **/","import m from 'mithril';\n\nconst loadComponent = {\n  controller: function (data) {\n    this.vm = data.vm;\n    this.tColor = false;\n    this.noop = (e) => {\n      e.preventDefault();\n    };\n  },\n  view: (ctrl) => {\n    const settingList = [];\n    if (ctrl.vm.status()) {\n      // systemImg\n      const systemImg = ctrl.vm.systemImg();\n      const systemImgView = m('.systemImg', [\n        m('h3', 'システムグラフィック'),\n        m('img', {\n          src: systemImg.dataUrl\n        }),\n        m('.tColor', [\n          '透過色: ',\n          m('span', {\n              style: {color: systemImg.tColorCss}\n            }, `■${systemImg.tColorCss}`)\n        ]),\n        m('h4', 'メッセージ枠ベース画像'),\n        m('img', {\n          src: systemImg.messageWindow\n        })\n      ]);\n      settingList.push(systemImgView);\n    }\n    return m('.loadComponent', [\n      m('h2', '設定ファイル'),\n      m('button.checkConfig', '現在の設定の確認'),\n      m('.settingList', {\n      }, settingList),\n      m('.loadConfig', {\n        ondragover: ctrl.noop,\n        ondrop: ctrl.vm.dropFiles.bind(ctrl.vm)\n      }, 'ここに設定ファイルをまとめてドロップしてください。')\n    ]);\n  }\n};\n\nexport default loadComponent;\n\n\n\n/** WEBPACK FOOTER **\n ** ./js/components/load-component.js\n **/","import LoadVM from './load-vm';\n\nexport default class TmaFrontVM {\n  constructor(data) {\n    this.loadVM = new LoadVM(data.scenario);\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./js/view-model/tma-front-vm.js\n **/","import m from 'mithril';\n// import Png from '../model/png';\nimport SystemImg from '../model/system-img';\n\nexport default class LoadVM {\n  constructor(scenario) {\n    // init member\n    this.style = m.prop();\n    this.status = m.prop(false);\n    this.peoples = [];\n    this.scenario = scenario;\n    this.systemImg = m.prop(false);\n    this.png = [];\n    // set styleSheet\n    this.styleSheet = false;\n    const styleSheets = document.styleSheets;\n    for (let i = 0; i < styleSheets.length; i++) {\n      if (styleSheets[i].href != null && styleSheets[i].href.endsWith('style.css')) {\n        this.styleSheet = styleSheets[i];\n      }\n    }\n  }\n\n  dropFiles(e) {\n    e.preventDefault();\n    const promises = [];\n    const files = e.dataTransfer.files;\n    for (let i = 0; i < files.length; i++) {\n      const file = files[i];\n      const ext = getFileExt(file.name);\n      if (file.name == 'style.yaml') {\n        promises.push(this._readStyleYaml(file));\n      } else if (ext == 'png') {\n        promises.push(this._readPng(file));\n      } else if (['yaml', 'yml'].includes(ext)) {\n        promises.push(this._readPeopleYaml(file));\n      }\n    }\n    m.sync(promises).then(() => {\n      this.scenario.setConfig(this.style(), this.peoples);\n      this.status(true);\n      // set CSS images\n      if (this.systemImg()) {\n        this._editCss('.messageWindow', 'border-image-source', `url(${this.systemImg().messageWindow})`);\n        this._editCss('.text', 'background-image', `url(${this.systemImg().defaultText})`);\n        for (let i = 0; i < 20; i++) {\n          this._editCss(`.color${i}`, 'background-image', `url(${this.systemImg().getTextColor(i)})`);\n        }\n        this._editCss(':root', '--control-base-color', this.systemImg().controlCharColor);\n        this._editCss(':root', '--control-sub-color', this.systemImg().controlCharBgColor);\n      }\n      // redraw\n      m.redraw();\n    });\n  }\n\n  _editCss(selector, name, value) {\n    this.styleSheet.insertRule(`${selector} { ${name}: ${value}}`, this.styleSheet.cssRules.length);\n  }\n\n  _readStyleYaml(file) {\n    const reader = new FileReader();\n    reader.readAsText(file);\n\n    const deferred = m.deferred();\n    reader.onloadend = (e) => {\n      this.style(e.target.result);\n      deferred.resolve(true);\n    };\n    reader.onerror = deferred.reject;\n\n    return deferred.promise;\n  }\n\n  _readPeopleYaml(file) {\n    const reader = new FileReader();\n    reader.readAsText(file);\n\n    const deferred = m.deferred();\n    reader.onloadend = (e) => {\n      this.peoples.push(e.target.result);\n      deferred.resolve(true);\n    };\n    reader.onerror = deferred.reject;\n\n    return deferred.promise;\n  }\n\n  _readPng(file) {\n    const deferred = m.deferred();\n    const reader = new FileReader();\n    const systemImg = new SystemImg(deferred);\n    reader.readAsArrayBuffer(file);\n    this.systemImg(systemImg); //TODO\n\n    reader.onloadend = systemImg.loadEnd.bind(systemImg);\n    reader.onerror = deferred.reject;\n\n    return deferred.promise;\n  }\n}\nconst getFileExt = (filename) => {\n  const dotIndex = filename.lastIndexOf('.');\n  if (dotIndex < 0) {\n    throw new Error('拡張子が有りません');\n  }\n  return filename.substr(dotIndex + 1);\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./js/view-model/load-vm.js\n **/","import Png from './png';\nimport oneColor from 'onecolor';\n\nexport default class SystemImg extends Png {\n  constructor(deferred) {\n    super(deferred);\n    this._messageWindowDataUrl = false;\n    this._messageWindowMainColor;\n  }\n\n  get messageWindowMainColor() {\n      return this._messageWindowMainColor;\n  }\n\n  get controlCharColor() {\n    if (!this._messageWindowMainColor) {\n      return false;\n    }\n    const bg = oneColor(this._messageWindowMainColor);\n    return bg.value() > .7 ? 'black' : 'white';\n  }\n\n  get controlCharBgColor() {\n    if (!this._messageWindowMainColor) {\n      return false;\n    }\n    const bg = oneColor(this._messageWindowMainColor);\n    return bg.value() > .7 ? 'white' : 'black';\n  }\n\n  get messageWindow() {\n    if (this.file == false) {\n      return false;\n    }\n    if (this._messageWindowDataUrl == false) {\n      // make messageWindow\n      const canvas = this._makeCanvas(32, 32);\n\n      // frame transparent set\n      const ctx = canvas.getContext('2d');\n      ctx.drawImage(this.img, 32, 0, 32, 32, 0, 0, 32, 32);\n      const imageData = ctx.getImageData(0, 0, 32, 32);\n      const tColor = this.palette[0];\n      for (let y = 0; y < canvas.height; y++) {\n        for (let x = 0; x < canvas.width; x++) {\n          const offset = (y * canvas.width + x) * 4;\n          // 中央\n          if (x >= 8 && x <= 24 && y >= 8 && y <= 24) {\n            imageData.data[offset + 3] = 0;\n            continue;\n          }\n          const r = imageData.data[offset];\n          const g = imageData.data[offset + 1];\n          const b = imageData.data[offset + 2];\n          if (tColor.r == r && tColor.g == g && tColor.b == b) {\n            imageData.data[offset + 3] = 0;\n          }\n        }\n      }\n\n      // frame serialize\n      ctx.putImageData(imageData, 0, 0);\n      const frame = new Image();\n      frame.src = canvas.toDataURL();\n\n      // draw background\n      ctx.drawImage(this.img, 0, 0, 32, 32, 0, 0, 32, 32);\n\n      // calc main color\n      const bgImageData = ctx.getImageData(0, 0, 32, 32);\n      const pixelNumber = canvas.height * canvas.width;\n      let h = 0, s = 0, l = 0;\n      for (let y = 0; y < canvas.height; y++) {\n        for (let x = 0; x < canvas.width; x++) {\n          const offset = (y * canvas.width + x) * 4;\n          const r = bgImageData.data[offset];\n          const g = bgImageData.data[offset + 1];\n          const b = bgImageData.data[offset + 2];\n          const color = oneColor(`rgb(${r}, ${g}, ${b})`);\n          // 色の平均を計算する\n          h += color.hue();\n          s += color.saturation();\n          l += color.lightness();\n        }\n      }\n      h /= pixelNumber;\n      s /= pixelNumber;\n      l /= pixelNumber;\n      this._messageWindowMainColor = oneColor([\"HSL\", h, s, l]).css();\n\n      // draw frame\n      ctx.drawImage(frame, 0, 0);\n\n      this._messageWindowDataUrl = canvas.toDataURL();\n    }\n    return this._messageWindowDataUrl;\n  }\n\n  get defaultText() {\n    return this.getTextColor(0);\n  }\n\n  getTextColor(number) {\n    // make background\n    const canvas = this._makeCanvas(16, 16);\n    const ctx = canvas.getContext('2d');\n    const x = 16 * (number % 10);\n    const y = 48 + Math.floor(number / 10) * 16;\n    ctx.drawImage(this.img, x, y, 16, 16, 0, 0, 16, 16);\n\n    return canvas.toDataURL();\n  }\n\n  _makeCanvas(w, h) {\n    const canvas = document.createElement('canvas');\n    canvas.width = w;\n    canvas.height = h;\n\n    return canvas;\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./js/model/system-img.js\n **/","import base64_arraybuffer from 'base64-arraybuffer';\n\nexport default class Png {\n  constructor(deferred) {\n    // private init\n    this.file = false;\n    this.dataUrl = false;\n    this.palette = [];\n    this.deferred = deferred;\n    this.img = false;\n  }\n\n  get imageInfo() {\n    return {\n      dataUrl: this.dataUrl,\n      palette: this.palette\n    };\n  }\n\n  loadEnd(e) {\n    if (e.target.readyState == FileReader.DONE) {\n      this.file = e.target.result;\n      // dataUrl変換、IMG要素追加\n      this.dataUrl = 'data:image/png;base64,' + base64_arraybuffer.encode(this.file);\n      this.img = new Image();\n      this.img.src = this.dataUrl;\n      // パレット読み込み\n      this.palette = this.readPlte(pngInfo.signature);\n      // resolve\n      this.deferred.resolve(true);\n    }\n  }\n\n  readPlte(offset) {\n    const buffer = this.file;\n    if (offset >= buffer.byteLength) {\n      return false;\n    }\n    const dv = new DataView(buffer);\n    const length = dv.getUint32(offset);\n    const name = [];\n    for (let i = 0; i < 4; i++) {\n      name.push(dv.getUint8(offset + pngInfo.chunk.length + i));\n    }\n    if (String.fromCharCode.apply(null, name) == 'PLTE') {\n      const palette = [];\n      const pOffset = offset + pngInfo.chunk.length + pngInfo.chunk.name;\n      const pLength = length / 3;\n      for (let i = 0; i < pLength; i++) {\n        palette.push(\n          {\n            r: dv.getUint8(pOffset + i * 3),\n            g: dv.getUint8(pOffset + i * 3 + 1),\n            b: dv.getUint8(pOffset + i * 3 + 2)\n          }\n        );\n      }\n      return palette;\n    } else {\n      return this.readPlte(offset + pngInfo.chunk.length + pngInfo.chunk.name + length + pngInfo.chunk.crc);\n    }\n  }\n\n  get tColorCss() {\n    if (!this.palette) {\n      return '';\n    }\n    const c = this.palette[0];\n    return `rgb(${c.r}, ${c.g}, ${c.b})`;\n  }\n}\n\nconst pngInfo = {\n  signature: 8,\n  chunk: {\n    length: 4,\n    name: 4,\n    crc: 4\n  }\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./js/model/png.js\n **/","module.exports = (__webpack_require__(2))(57);\n\n\n/*****************\n ** WEBPACK FOOTER\n ** delegated ./node_modules/base64-arraybuffer/lib/base64-arraybuffer.js from dll-reference vendor_library\n ** module id = 10\n ** module chunks = 0\n **/","import m from 'mithril';\n\nexport default class Zoom {\n  constructor(data) {\n    data = data || {};\n    this.zoomLevel = m.prop(data.zoomLevel || 1);\n  }\n\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./js/model/zoom.js\n **/","import m from 'mithril';\nimport {ScenarioParser} from 'tk2k-message-assist';\n\nexport default class Scenario {\n  constructor() {\n    this.parser = false;\n    this.scenarioText = m.prop('');\n  }\n\n  get tkScript() {\n    if (this.parser) {\n      return this.parser.serialize();\n    }\n  }\n\n  get windowList() {\n    const scenario = this.scenarioText();\n\n    if (this.parser && scenario) {\n      return this.parser.parse(scenario);\n    }\n\n    return [];\n  }\n\n  setConfig(style, peoples) {\n    this.parser = new ScenarioParser(style, peoples);\n  }\n\n  get colors() {\n    if (this.parser) {\n      return this.parser.config.colors;\n    }\n    return [];\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./js/model/scenario.js\n **/","'use strict';\n\nvar _scenarioParser = require('./scenario-parser');\n\nvar _scenarioParser2 = _interopRequireDefault(_scenarioParser);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nmodule.exports = {\n  ScenarioParser: _scenarioParser2.default\n};\n\n\n/** WEBPACK FOOTER **\n ** ./~/tk2k-message-assist/lib/index.js\n **/","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _message = require('./message');\n\nvar _message2 = _interopRequireDefault(_message);\n\nvar _messageBlock = require('./message-block');\n\nvar _messageBlock2 = _interopRequireDefault(_messageBlock);\n\nvar _config = require('./config');\n\nvar _config2 = _interopRequireDefault(_config);\n\nvar _tbSerializer = require('./tb-serializer');\n\nvar _tbSerializer2 = _interopRequireDefault(_tbSerializer);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n// 単独タグ正規表現\nvar noEndTagRegExp = /<([a-z\\-\\_]+) \\/>/g;\n// 顔グラ変更命令正規表現\nvar faceCommandRegExp = /^\\[([^\\]]+)]$/;\n\nvar ScenarioParser = function () {\n  function ScenarioParser(style) {\n    var _this = this;\n\n    var faces = arguments.length <= 1 || arguments[1] === undefined ? [] : arguments[1];\n\n    _classCallCheck(this, ScenarioParser);\n\n    this.continueTag = '';\n    this.config = new _config2.default();\n    this.config.loadStyleYaml(style);\n    faces.forEach(function (face) {\n      _this.config.loadPersonYaml(face);\n    });\n    this.serializer = new _tbSerializer2.default(this.config);\n    this.parsedMessages = false;\n  }\n\n  _createClass(ScenarioParser, [{\n    key: 'parse',\n    value: function parse(input) {\n      var _this2 = this;\n\n      // trimと配列化\n      var textList = input.split(\"\\n\").map(function (value) {\n        return value.trim();\n      });\n\n      // 継続タグの初期化\n      this.continueTag = '';\n\n      // limit別に分ける\n      var result = [];\n      var tmp = [];\n      var block = new _messageBlock2.default(false);\n      textList.forEach(function (text) {\n        if (_this2.config.hasFace && faceCommandRegExp.test(text)) {\n          // 顔グラ変更\n          var faceCommand = text.substr(1, text.length - 2);\n          var faceConfig = _this2.config.getFace(faceCommand);\n          if (!faceConfig) {\n            throw new Error('未知の顔グラフィックです。：' + faceCommand);\n          }\n          // メッセージブロックの作り直し\n          if (tmp.length > 0) {\n            block.addMessage(_this2._tagFormat(tmp));\n            tmp = [];\n          }\n          if (block.hasMessage()) {\n            result.push(block);\n          }\n          block = new _messageBlock2.default(faceConfig);\n          return; //continue\n        }\n        tmp.push(text);\n        if (tmp.length == _this2.config.lineLimit) {\n          block.addMessage(_this2._tagFormat(tmp));\n          tmp = [];\n        }\n      });\n      if (tmp.length > 0) {\n        block.addMessage(this._tagFormat(tmp));\n      }\n      if (block.hasMessage()) {\n        result.push(block);\n      }\n\n      this.parsedMessages = result;\n\n      return result;\n    }\n  }, {\n    key: 'serialize',\n    value: function serialize() {\n      if (!this.parsedMessages) {\n        return '';\n      }\n      return this.serializer.serialize(this.parsedMessages);\n    }\n  }, {\n    key: '_tagFormat',\n    value: function _tagFormat(textList) {\n      var _this3 = this;\n\n      // 前回からの継続タグを追加\n      var input = this.continueTag + textList.join(\"\\n\").replace(noEndTagRegExp, \"<$1></$1>\");\n      // 継続タグのチェック\n      var stack = [];\n      var tags = input.match(/.?<\\/?[a-z\\_\\-]+>/g);\n      if (tags) {\n        tags.forEach(function (tag) {\n          if (tag.startsWith('\\\\')) {\n            // エスケープ文字付きの場合対応しない\n            return;\n          }\n          tag = tag.replace(/.?(<\\/?[a-z\\_\\-]+>)/, '$1');\n          if (tag.startsWith('</')) {\n            // 閉じタグ\n            var lastTag = stack.pop(tag);\n            if (lastTag != tag.substr(2, tag.length - 3)) {\n              throw new Error('タグの対応がおかしいです。: ' + lastTag);\n            }\n          } else {\n            // 開始タグ\n            stack.push(tag.substr(1, tag.length - 2));\n          }\n        });\n      }\n      if (stack.length > 0) {\n        (function () {\n          var prev = '';\n          _this3.continueTag = stack.filter(function (v) {\n            if (prev != v) {\n              prev = v;\n              return true;\n            }\n          }).map(function (v) {\n            return '<' + v + '>';\n          }).join('');\n        })();\n      }\n\n      // 最終出力\n      var output = input + stack.reverse().map(function (v) {\n        return '</' + v + '>';\n      }).join('');\n\n      return new _message2.default(output.trim().split(\"\\n\"));\n    }\n  }]);\n\n  return ScenarioParser;\n}();\n\nexports.default = ScenarioParser;\n\n\n/** WEBPACK FOOTER **\n ** ./~/tk2k-message-assist/lib/scenario-parser.js\n **/","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Message = function Message(textList) {\n  _classCallCheck(this, Message);\n\n  this.line = textList;\n};\n\nexports.default = Message;\n\n\n/** WEBPACK FOOTER **\n ** ./~/tk2k-message-assist/lib/message.js\n **/","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar MessageBlock = function () {\n  function MessageBlock(face) {\n    _classCallCheck(this, MessageBlock);\n\n    this.face = face || false;\n    this.messageList = [];\n  }\n\n  _createClass(MessageBlock, [{\n    key: \"addMessage\",\n    value: function addMessage(message) {\n      this.messageList.push(message);\n    }\n  }, {\n    key: \"hasMessage\",\n    value: function hasMessage() {\n      return this.messageList.length > 0;\n    }\n  }]);\n\n  return MessageBlock;\n}();\n\nexports.default = MessageBlock;\n\n\n/** WEBPACK FOOTER **\n ** ./~/tk2k-message-assist/lib/message-block.js\n **/","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _jsYaml = require('js-yaml');\n\nvar _jsYaml2 = _interopRequireDefault(_jsYaml);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Config = function () {\n  function Config() {\n    _classCallCheck(this, Config);\n\n    this._config = {\n      color: {},\n      style: {},\n      face: {}\n    };\n  }\n\n  _createClass(Config, [{\n    key: 'getColorNumber',\n    value: function getColorNumber(name) {\n      return this._config.color[name] ? this._config.color[name] : false;\n    }\n  }, {\n    key: 'getFace',\n    value: function getFace(faceKey) {\n      if (!this.hasFace) {\n        return false;\n      }\n\n      return this._config.face[faceKey] ? this._config.face[faceKey] : false;\n    }\n  }, {\n    key: 'loadStyleYaml',\n    value: function loadStyleYaml(yaml) {\n      var yamlObj = _jsYaml2.default.load(yaml);\n      // 色設定はそのまま読み込む\n      this._config.color = yamlObj.color ? yamlObj.color : false;\n      // スタイル設定はそのまま読み込む\n      this._config.style = yamlObj.style ? yamlObj.style : false;\n      // 顔設定の初期化\n      this._config.face = {};\n    }\n  }, {\n    key: 'loadPersonYaml',\n    value: function loadPersonYaml(yaml) {\n      var _this = this;\n\n      var yamlObj = _jsYaml2.default.load(yaml);\n      if (yamlObj.person) {\n        if (!this._config.style) {\n          // スタイル設定が無い場合、エラー\n          throw new Error('スタイル設定が足りてません');\n        }\n        Object.keys(yamlObj.person).forEach(function (name) {\n          var person = yamlObj.person[name];\n          Object.keys(person.faces).forEach(function (faceName) {\n            var face = person.faces[faceName];\n            var templateConfig = _this._config.style.template.face;\n            var nameConfig = _this._config.style.display.name;\n            var faceKey = '' + name + templateConfig.prefix + faceName + templateConfig.suffix;\n            var color = face.color || person.color || false;\n            var displayName = face.name || person.name;\n            if (color && nameConfig.colorScope == 'inner') {\n              displayName = nameConfig.prefix + '<' + color + '>' + displayName + '</' + color + '>' + nameConfig.suffix;\n            } else if (color && nameConfig.colorScope == 'outer') {\n              displayName = '<' + color + '>' + nameConfig.prefix + displayName + nameConfig.suffix + '</' + color + '>';\n            } else {\n              displayName = '' + nameConfig.prefix + displayName + nameConfig.suffix;\n            }\n            face.name = displayName;\n            _this._config.face[faceKey] = face;\n          });\n        });\n      }\n    }\n  }, {\n    key: 'hasFace',\n    get: function get() {\n      return Object.keys(this._config.face).length > 0;\n    }\n  }, {\n    key: 'faceKeyList',\n    get: function get() {\n      if (!this.hasFace) {\n        return [];\n      }\n      return Object.keys(this._config.face);\n    }\n  }, {\n    key: 'lineLimit',\n    get: function get() {\n      return this._config.style.display.lineLimit;\n    }\n  }, {\n    key: 'colors',\n    get: function get() {\n      return this._config.color;\n    }\n  }]);\n\n  return Config;\n}();\n\nexports.default = Config;\n\n\n/** WEBPACK FOOTER **\n ** ./~/tk2k-message-assist/lib/config.js\n **/","module.exports = (__webpack_require__(2))(3);\n\n\n/*****************\n ** WEBPACK FOOTER\n ** delegated ./node_modules/js-yaml/index.js from dll-reference vendor_library\n ** module id = 18\n ** module chunks = 0\n **/","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar TbSerializer = function () {\n  function TbSerializer(config) {\n    _classCallCheck(this, TbSerializer);\n\n    this.config = config;\n  }\n\n  _createClass(TbSerializer, [{\n    key: 'serialize',\n    value: function serialize(messageBlockList) {\n      var _this = this;\n\n      var result = [];\n      messageBlockList.forEach(function (messageBlock) {\n        // 顔グラ関連\n        var faceMessage = false;\n        if (messageBlock.face) {\n          // TODO pos, mirror\n          result.push('Faice(\"' + messageBlock.face.filename + '\", ' + messageBlock.face.number + ', 0, 0)');\n          faceMessage = _this._toTbScript(messageBlock.face.name);\n        }\n        messageBlock.messageList.forEach(function (message) {\n          // タグ置換\n          var line = message.line.map(function (text) {\n            return _this._toTbScript(text);\n          });\n\n          // 改行を置換してまとめる\n          if (faceMessage) {\n            line.unshift(faceMessage);\n          }\n          result.push('Text(\"' + line.join(cChar.br) + '\")');\n        });\n      });\n      return result.join(\"\\n\");\n    }\n  }, {\n    key: '_toTbScript',\n    value: function _toTbScript(text) {\n      var _this2 = this;\n\n      // タグとメッセージに分解\n      var parts = text.split(/(\\\\?<\\/?[a-z\\-\\_]+>)/);\n      if (parts.length == 1) {\n        // 変換無し\n        return this._removeEscapeChar(text);\n      }\n      // タグの変換\n      var prevColor = 0;\n      var colorStack = [];\n      parts = parts.map(function (part) {\n        if (/^<[a-z\\-\\_]+>$/.test(part)) {\n          // 開始タグ\n          var tagName = part.substr(1, part.length - 2);\n          var colorNumber = _this2.config.getColorNumber(tagName);\n          if (colorNumber) {\n            // 色タグ\n            colorStack.push(prevColor);\n            prevColor = colorNumber;\n            return cChar.color + '[' + colorNumber + ']';\n          }\n          // 制御タグ\n          return '' + _this2._getCChar(tagName);\n        } else if (/^<\\/[a-z\\-\\_]+>$/.test(part)) {\n          // 閉じタグ\n          var _tagName = part.substr(2, part.length - 3);\n          if (!_this2.config.getColorNumber(_tagName) === false) {\n            // 色タグ\n            prevColor = colorStack.pop();\n            return cChar.color + '[' + prevColor + ']';\n          } else if (cNormalTags.includes(_tagName)) {\n            // 閉じタグ有りの制御タグ\n            return '' + _this2._getCChar(_tagName + '_end');\n          } else if (cNoEndTags.includes(_tagName)) {\n            // 閉じタグが無いタグの場合、空\n            return '';\n          }\n        }\n        // タグ以外のテキストの場合、エスケープ文字を消す\n        return _this2._removeEscapeChar(part);\n      });\n      return parts.join('');\n    }\n  }, {\n    key: '_getCChar',\n    value: function _getCChar(name) {\n      if (!cChar[name]) {\n        throw new Error('対応していないタグです。: ' + name);\n      }\n      return cChar[name];\n    }\n  }, {\n    key: '_removeEscapeChar',\n    value: function _removeEscapeChar(text) {\n      return text.replace(/([^\\\\]?)\\\\/, '$1').replace('\\\\', '\\\\\\\\');\n    }\n  }]);\n\n  return TbSerializer;\n}();\n\nexports.default = TbSerializer;\n\n\nvar cChar = {\n  br: '\\\\k',\n  color: '\\\\C',\n  stop: '\\\\!',\n  wait: '\\\\|',\n  q_wait: '\\\\.',\n  flash: '\\\\>',\n  flash_end: '\\\\<'\n};\n\nvar cNoEndTags = ['stop', 'wait', 'q_wait'];\nvar cNormalTags = ['flash'];\n\n\n/** WEBPACK FOOTER **\n ** ./~/tk2k-message-assist/lib/tb-serializer.js\n **/","module.exports = (__webpack_require__(2))(38);\n\n\n/*****************\n ** WEBPACK FOOTER\n ** delegated ./node_modules/onecolor/index.js from dll-reference vendor_library\n ** module id = 20\n ** module chunks = 0\n **/"],"sourceRoot":""}